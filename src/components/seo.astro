---
import { SEO } from "astro-seo";
import { DEFAULT_DESCRIPTION, DEFAULT_TITLE, SITE_URL } from "../constants";

interface Props {
	title?: string;
	description?: string;
	image?: string;
	article?: {
		publishedTime?: string;
		modifiedTime?: string;
		authors?: string[];
		tags?: string[];
	};
	noindex?: boolean;
	nofollow?: boolean;
}

const defaultImage = `${SITE_URL}/og-image.png`;

const {
	title = DEFAULT_TITLE,
	description = DEFAULT_DESCRIPTION,
	image = defaultImage,
	article,
	noindex = false,
	nofollow = false,
} = Astro.props;

const fullTitle = title === DEFAULT_TITLE
	? title
	: `${title} | ${DEFAULT_TITLE}`;

const pathname = Astro.url.pathname;
const normalizedPath = pathname === "/"
	? "/"
	: pathname.replace(/\/$/, "");

const canonicalUrl = `${SITE_URL}${normalizedPath}`;
---

<SEO
	title={fullTitle}
	description={description}
	canonical={canonicalUrl}
	noindex={noindex}
	nofollow={nofollow}
	openGraph={{
		basic: {
			title: title,
			type: article ? "article" : "website",
			image: image,
			url: canonicalUrl,
		},
		optional: {
			description: description,
			siteName: DEFAULT_TITLE,
			locale: "en_US",
		},
		image: {
			alt: title,
		},
		article: article
			? {
					publishedTime: article.publishedTime,
					modifiedTime: article.modifiedTime,
					authors: article.authors,
					tags: article.tags,
				}
			: undefined,
	}}
	twitter={{
		card: "summary_large_image",
		site: "@fraugsleeves",
		creator: "@fraugsleeves",
		title: title,
		description: description,
		image: image,
		imageAlt: title,
	}}
	extend={{
		meta: [
			{ name: "author", content: "Mikey Sleevi" },
			{ name: "generator", content: Astro.generator },
		],
	}}
/>
