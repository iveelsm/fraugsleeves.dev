---
import { SEO } from "astro-seo";

import {
	DEFAULT_DESCRIPTION,
	DEFAULT_IMAGE,
	DEFAULT_TITLE,
	SITE_URL,
	DEFAULT_ALT,
} from "../constants";

interface Props {
	title?: string;
	description?: string;
	image?: string;
	alt?: string;
	article?: {
		publishedTime: string;
		modifiedTime?: string;
		authors: string[];
		tags: string[];
	};
	noindex?: boolean;
	nofollow?: boolean;
}

const {
	title = DEFAULT_TITLE,
	description = DEFAULT_DESCRIPTION,
	image = DEFAULT_IMAGE,
	alt = DEFAULT_ALT,
	article,
	noindex = false,
	nofollow = false,
} = Astro.props;

const pathname = Astro.url.pathname;
const normalizedPath = pathname === "/" ? "/" : pathname.replace(/\/$/, "");

const canonicalUrl = `${SITE_URL}${normalizedPath}`;
---

<SEO
	title={title}
	description={description}
	canonical={canonicalUrl}
	noindex={noindex}
	nofollow={nofollow}
	openGraph={{
		basic: {
			title: title,
			type: article ? "article" : "website",
			image: image,
			url: canonicalUrl,
		},
		optional: {
			description: description,
			siteName: DEFAULT_TITLE,
			locale: "en_US",
		},
		image: {
			alt: title,
		},
		article: article
			? {
					publishedTime: article.publishedTime,
					modifiedTime: article.modifiedTime || article.publishedTime,
					authors: article.authors,
					tags: article.tags,
					section: "Technology",
				}
			: undefined,
	}}
	twitter={{
		creator: "@iveelsm",
		title: title,
		description: description,
		card: "summary_large_image",
		image: image,
		imageAlt: alt,
	}}
/>
